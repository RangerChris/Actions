name: Show build and release number
run-name: "${{ github.event_name }} #${{ github.run_number }}.${{ github.run_attempt }} | ${{ github.ref_name }}"
on:
  push:
    branches: ["main"]
  pull_request:
    branches: ["main"]

  workflow_dispatch:

env:
  BUILD_NUMBER: ${{ github.run_number }}
  RUN_URL: ${{ github.server_url }}/${{ github.repository }}/actions/runs/${{ github.run_id }}

jobs:
  build:
    runs-on: ubuntu-latest

    steps:
      - uses: actions/checkout@v4

      - name: Build and test
        run: |
          echo "=== BUILD CONTEXT ==="
          echo "Workflow: ${{ github.workflow }}"
          echo "Job: ${{ github.job }}"
          echo "Event: ${{ github.event_name }}"
          echo "Build Number: $BUILD_NUMBER"
          echo "Run Attempt: ${{ github.run_attempt }}"
          echo "Run ID: ${{ github.run_id }}"
          echo "Run URL: $RUN_URL"
          echo "Repository: ${{ github.repository }}"
          echo "Branch: ${{ github.ref_name }}"
          echo "Ref: ${{ github.ref }}"
          echo "Commit SHA: ${{ github.sha }}"
          echo "PR Number: ${{ github.event.pull_request.number }}"
          echo "Triggered By: ${{ github.actor }}"
          echo "Runner: ${{ runner.os }}-${{ runner.arch }}"
          echo "Timestamp (UTC): $(date -u +'%Y-%m-%dT%H:%M:%SZ')"
          echo ""
          echo "=== BUILD ACTIONS ==="
          echo "Running locally"
          echo "Building application"
          echo "Running tests"
          echo "Preparing for deployment"

  deploy:
    needs: build
    runs-on: ubuntu-latest
    environment: Development

    steps:
      - uses: actions/checkout@v4

      - name: Deploy to Development
        run: |
          echo "=== DEPLOY CONTEXT ==="
          echo "Workflow: ${{ github.workflow }}"
          echo "Job: ${{ github.job }}"
          echo "Environment: Development"
          echo "Event: ${{ github.event_name }}"
          echo "Build Number: $BUILD_NUMBER"
          echo "Run Attempt: ${{ github.run_attempt }}"
          echo "Run ID: ${{ github.run_id }}"
          echo "Run URL: $RUN_URL"
          echo "Repository: ${{ github.repository }}"
          echo "Branch: ${{ github.ref_name }}"
          echo "Commit SHA: ${{ github.sha }}"
          echo "Triggered By: ${{ github.actor }}"
          echo "Runner: ${{ runner.os }}-${{ runner.arch }}"
          echo "Timestamp (UTC): $(date -u +'%Y-%m-%dT%H:%M:%SZ')"
          echo ""
          echo "=== DEPLOY ACTIONS ==="
          echo "Deploying to Development environment"
          echo "Running deployment scripts and configurations for Development"
          echo "MY_ACTION_VALUE: $MY_ACTION_VALUE"
